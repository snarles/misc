(function(){var b={HTMLEvents:/^(?:load|unload|abort|error|select|change|submit|reset|focus|blur|resize|scroll)$/,MouseEvents:/^(?:click|mouse(?:down|up|over|move|out))$/};var a={pointerX:0,pointerY:0,button:0,ctrlKey:false,altKey:false,shiftKey:false,metaKey:false,bubbles:true,cancelable:true};Event.simulate=function(h,d){var f=Object.extend(Object.clone(a),arguments[2]||{});var c,g=null;h=$(h);for(var e in b){if(b[e].test(d)){g=e;break}}if(!g){throw new SyntaxError("Only HTMLEvents and MouseEvents interfaces are supported")}if(document.createEvent){c=document.createEvent(g);if(g=="HTMLEvents"){c.initEvent(d,f.bubbles,f.cancelable)}else{c.initMouseEvent(d,f.bubbles,f.cancelable,document.defaultView,f.button,f.pointerX,f.pointerY,f.pointerX,f.pointerY,f.ctrlKey,f.altKey,f.shiftKey,f.metaKey,f.button,h)}h.dispatchEvent(c)}else{f.clientX=f.pointerX;f.clientY=f.pointerY;c=Object.extend(document.createEventObject(),f);h.fireEvent("on"+d,c)}return h};Element.addMethods({simulate:Event.simulate})})();function unsafe(a){a=a.replace?a:"";return a.replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&amp;/g,"&")}function stripHTMLTagsDangerously(a){return a.replace(/<[^>]+>/g,"")}function hide(){for(var a=0;a<arguments.length;a++){var b=$(arguments[a]);if(b){b.style.display="none"}}}function show(){for(var a=0;a<arguments.length;a++){var b=$(arguments[a]);if(b){b.style.display=""}}}function __iter__(c,b){var a=[];for(var d in c){if(!(d in Object.prototype)){a.unshift(b(d,c[d]))}}return a}function make_get_params(a){return __iter__(a,function(b,c){return b+"="+encodeURIComponent(c)}).join("&")}function update_get_params(b){var a={};__iter__(where.params,function(c,d){a[c]=d});if(b){__iter__(b,function(c,d){a[c]=d})}return a}function relative_path(b){var a=update_get_params(b);path=where.path;if(a){path+="?"+make_get_params(a)}return path}function _id(a){if(a&&a.id){var b=a.id;if(b.value){b=b.value}b=b.split("_");if(b.length>2){b=b[b.length-2]+"_"+b[b.length-1];if(b==null){return""}return b}}return""}function buildParams(b){if(b){try{var d=new Array();for(var a=0;a+1<b.length;a+=2){d.push(b[a]+"="+encodeURIComponent(b[a+1]))}b=d.join("&")}catch(c){b="";alert(c)}}return b}function redditRequest(e,j,a,d,k){k=k||{};var h=k.api_loc||"/api/";var f=k.prehandle_func;var i=k.cleanup_func;var b=k.handle_obj;var g=h+e;var c=a;if(!j){j={}}if(post_site){j.r=post_site}if(cnameframe){j.cnameframe=1}if(!c){c=handleResponse(e,{cleanup_func:i,prehandle_func:f,handle_obj:b})}else{c=function(l){remove_ajax_work(e);return a(l)}}if(!d||add_ajax_work(e)){new Ajax.Request(g,{parameters:make_get_params(j),onComplete:c})}}var _ajax_work_queue={};function add_ajax_work(a){if(_ajax_work_queue[a]){return false}_ajax_work_queue[a]=true;return true}function remove_ajax_work(a){_ajax_work_queue[a]=false}function redditRequest_no_response(b,a){redditRequest(b,a,function(c){})}function get_class_from_id(a){if(a){a=a.split("_")[0];return class_dict[a]}}function parse_response(a){if(a.status==500){return}return a.responseText.evalJSON()}function tup(a){if(!a.length){return[a]}return a}function applyStylesheet(c){var g="applied_subreddit_stylesheet";if(document.styleSheets[0].cssText){for(var a=0;a<document.styleSheets.length;a++){if(document.styleSheets[a].title==g){document.styleSheets[a].cssText=c;break}}}else{var e=document.getElementsByTagName("head")[0];var f=e.childNodes;for(var a=0;a<f.length;a++){var d=f[a];if(d.title==g){e.removeChild(d);break}}var b=document.createElement("style");b.type="text/css";b.rel="stylesheet";b.media="screen";b.title=g;b.textContent=c;e.appendChild(b)}}function showDefaultStylesheet(){return toggleDefaultStylesheet(true)}function hideDefaultStylesheet(){return toggleDefaultStylesheet(false)}function toggleDefaultStylesheet(e){var a=$("stylesheet_contents").parentNode.parentNode;var d=$("default_stylesheet").parentNode.parentNode;var c=$("show_default_stylesheet");var b=$("hide_default_stylesheet");if(e){d.style.width="50%";a.style.width="50%";show(d,b);hide(c)}else{a.style.width="100%";d.style.width="";show(c);hide(d,b)}return false}function gotoTextboxLine(k,c){var g=$(k);var j=g.value;var b="\n";var e=1;var m=0;if(j.indexOf("\r")>0){b="\r";e=0;m=1}var l=g.value.split(b);for(var h=0;h<c-1;h++){m+=l[h].length+e}var i=m;if(c<l.length){i+=l[c-1].length+e}g.focus();if(g.createTextRange){var a=g.createTextRange();a.move("character",m);var d=g.createTextRange();d.move("character",i);a.setEndPoint("StartToEnd",d);a.select()}else{if(g.selectionStart){g.setSelectionRange(m,i)}}if(g.scrollHeight){var f=g.scrollHeight/l.length;g.scrollTop=(c-2)*f}}function insertAtCursor(a,e){a=$(a);var b=a.scrollTop;if(document.selection){a.focus();var d=document.selection.createRange();d.text=e}else{if(a.selectionStart){var c=a.selectionStart;a.value=a.value.substring(0,a.selectionStart)+e+a.value.substring(a.selectionEnd,a.value.length);c+=e.length;a.setSelectionRange(c,c)}else{a.value+=e}}if(a.scrollHeight){a.scrollTop=b}a.focus()}function upload_image(b,a){$("img-status").innerHTML=a;show("img-status");return true}function completedUploadImage(c,l,a,n){show("img-status");$("img-status").innerHTML=c;for(var d=0;d<n.length;d++){var j=$(n[d][0]);if(n[d][1]){show(j);j.innerHTML=n[d][1]}else{hide(j)}}if(l){$("image-upload").reset();hide("submit-header-img");if(!a){$("header-img").src=l;$("img-preview").src=l;show("delete-img");hide("submit-img");show("img-preview-container")}else{var f=$("img-preview_"+a);if(f){}else{var k=$("image-preview-list");var o=$("img-prototype").cloneNode(true);o.id="img-li_";k.appendChild(o);re_id_node(o,""+a);var g=$("img_name_"+a);if(g){g.innerHTML=a}var m=$("img_url_"+a);if(m){m.innerHTML="url(%%"+a+"%%)"}f=$("img-preview_"+a);var h=$("old-names");if(h){var b=document.createElement("option");b.innerHTML=a;h.appendChild(b)}}f.src=l;$("img-preview-a_"+a).href=l;show("img-li_"+a)}}}function handleResponseErrorsRedirects(c){if(!c){if($("status")){$("status").innerHTML=""}return false}if(c.redirect){if(window.location.toString()==unsafe(c.redirect)){window.location.reload(true);return false}window.location=unsafe(c.redirect);return false}var a=c.error;if(a&&a.name){var b=a.name;if(a.id){b+="_"+a.id}b=$(b);if(b){show(b);$(b).innerHTML=a.message}}}function handleResponse(action,options){options=options||{};var prehandle_func=options.prehandle_func;var cleanup_func=options.cleanup_func;var handle_obj=options.handle_obj!==void 0?options.handle_obj:true;var my_iter=function(x,func){if(x){var y=tup(x);for(var j=0;j<y.length;j++){func(y[j])}}};var responseHandler=function(r){remove_ajax_work(action);var res_obj=parse_response(r);if(prehandle_func){prehandle_func(res_obj)}if(handleResponseErrorsRedirects(res_obj)===false){return}if(cleanup_func){cleanup_func(res_obj)}var r=res_obj.response;if(!r){return}var obj=r.object;if(handle_obj&&obj){my_iter(tup(obj),function(u){if(u&&u.kind&&class_dict[u.kind]){var func=(class_dict[u.kind][u.action]||class_dict[u.kind][action]);if(func){func(u.data)}}})}if(r.call){var calls=r.call;for(var i=0;i<calls.length;i++){eval(calls[i])}}if(r.focus){var f=$(r.focus);if(f){f.focus();f.onfocus=null}}if(r.blur){var f=$(r.blur);if(f){f.blur();f.onblur=null}}if(r.captcha){if(r.captcha.refresh){var id=r.captcha.id;var captcha=$("capimage"+(id?("_"+id):""));var capiden=$("capiden"+(id?("_"+id):""));capiden.value=r.captcha.iden;captcha.src=("/captcha/"+r.captcha.iden+".png?"+Math.random())}}if(r.success){fire_success()}my_iter(r.update,function(u){var field=u.id&&$(u.id);if(field){for(var i in u){if(typeof(u[i])!="function"&&u!="name"){field[i]=unsafe(u[i])}}}});my_iter(r.hide,function(h){var field=h.name&&$(h.name);if(field){hide(field)}});my_iter(r.show,function(h){var field=h.name&&$(h.name);if(field){show(field)}})};return responseHandler}function re_id_node(d,e){function a(f){if(e&&f&&typeof(f)=="string"){if(f.substr(f.length-1)!="_"){f+="_"}f+=e}return f}if(d.id&&typeof(d.id)=="string"){d.id=a(d.id)}if(d.htmlFor){a(d.htmlFor)}var c=d.childNodes;for(var b=0;b<c.length;b++){re_id_node(c[b],e)}return d}function field(a){if(a==null||a.value==null||((a.type=="text"||a.type=="textarea")&&a.style.color=="gray")||(a.type=="radio"&&!a.checked)){return""}else{if(a.type=="checkbox"){return a.checked?"on":"off"}}return a.value}function change_w_callback(e,d){var b=e.parentNode;var c=b.parentNode;var f=c.id.value;e.blur();var a=document.createElement("span");a.innerHTML=c.executed.value;b.insertBefore(a,e);hide(e);d(f);return false}function change_state(b,a){change_w_callback(b,function(c){redditRequest(a,{id:c,uh:modhash})});return false}function change_state_by_class(e,c,b){var a=e.parentNode;var d=a.parentNode;var f=d.id.value;if(e.hasClassName(b)){e.removeClassName(b)}else{e.addClassName(b)}redditRequest(c,{id:f,uh:modhash});return false}function post_form(d,n,e,g,j,q,s){s=s||{};var r=s.cleanup_func;var h=s.worker_func;var l=s.prehandle_func;var a=s.handle_obj;var c={uh:modhash};var b=_id(d);var k=$("status");if(e==null){e=function(f){return _global_submitting_tag}}if(g==null){g=function(f){return f}}if(b){k=$("status_"+b);c.id=b}if(k){k.innerHTML=e(d)}for(var m=0;m<d.elements.length;m++){if(!d.elements[m].id||!b||_id(d.elements[m])==b){var o=field(d.elements[m]);if(o){c[g(d.elements[m].name)]=o}}}redditRequest(n,c,h,j,{api_loc:q,cleanup_func:r,prehandle_func:l,handle_obj:a});return false}function setMessage(a,b){if(!a.value||a.value==b){a.value=b;a.style.color="gray"}else{a.onfocus=null}}function more(b,a,e,d){var f=b.innerHTML;b.innerHTML=a;var c;for(c=0;c<e.length;c++){show(e[c])}for(c=0;c<d.length;c++){hide(d[c])}b.onclick=function(){return more(b,f,d,e)};return false}function new_captcha(){redditRequest("new_captcha")}function view_embeded_media(i,a){var c="embeded_media_"+i;var d="view_embeded_media_span_watch_"+i;var b="view_embeded_media_span_close_"+i;var f=document.getElementById(d);var h=document.getElementById(b);var g=document.getElementById(c);if(g.style.display=="none"){g.style.display="block";g.innerHTML=a;f.style.display="none";h.style.display="inline"}else{g.style.display="none";f.style.display="inline";h.style.display="none"}}function show_hide_child(c,b,a){code_block=c.parentNode.getElementsByTagName(b)[0];if(code_block.style.display=="none"){show(code_block);c.innerHTML="hide "+a}else{if(code_block.style.display==""){hide(code_block);c.innerHTML="view "+a}}}function continueEditing(a){var b=document.getElementById("newlink");if(b&&a){b.keep_editing.value="on"}return true}var BeforeUnload=(function(){var e=false;var b=[];function a(j){var i=Array.prototype.slice.call(j,0);return{func:i[0],args:i.slice(1)}}function f(i,l){if(i.func!==l.func||i.args.length!==l.args.length){return false}for(var j=0,k=i.args.length;j<k;++j){if(i.args[j]!==l.args[j]){return false}}return true}function d(m){for(var l=0,i=b.length;l<i;++l){var k=b[l];var j=k.func.apply(this,k.args);if(j){return m.returnValue=j}}}function g(i){if(i&&!e){jQuery(window).bind("beforeunload",d);e=true}else{if(!i&&e){jQuery(window).unbind("beforeunload",d);e=false}}}function h(){b.push(a(arguments));g(true)}function c(){var i=a(arguments);for(var j=b.length-1;j>=0;--j){if(f(b[j],i)){b.splice(j,1)}}g(b.length>0)}return{bind:h,unbind:c}})();function invalidateWikiSubmit(a){jQuery.ajax({url:a.action,type:a.method,data:jQuery(a).serialize(),success:function(){window.location.reload()},error:function(){window.alert("Failed to invalidate the cache.")}});return false};var aniqueue=[];var _frameRate=15;var _duration=750;var _ani_speeds={slow:2*_duration,medium:_duration,fast:_duration/2,veryfast:_duration/4};function __animate(){var b=aniqueue?aniqueue[0]:[];var d=[];for(var c=0;c<b.length;c++){var e=b[c]();if(e){d.unshift(b[c])}}if(d.length>0){aniqueue[0]=d}else{aniqueue=aniqueue.slice(1)}if(!aniqueue.length&&animator){stop_animate()}}var animator;function add_to_aniframes(b,a){a=a||0;if((a>=0&&aniqueue.length<=a)||aniqueue.length==0){aniqueue.push([]);a=Math.min(aniqueue.length-1,a)}aniqueue[a].unshift(b);if(!animator){setTimeout(function(){start_animate(_frameRate)},30)}return a}function animate(e,a,f,b){var h=null;var c=a?1:0;if(_ani_speeds[f]){f=_ani_speeds[f]}f=f||_duration;add_to_aniframes(function(){h=h||new Date().getTime();var g=(new Date().getTime()-h)/f;g=c?g:1-g;g=Math.max(Math.min(g,1),0);try{e(g);return(g!=c)}catch(d){return false}},b)}function start_animate(a){if(!animator){animator=setInterval(__animate,a)}}function stop_animate(){clearInterval(animator);animator=null};function Thing(b,a){this.__init__(b,a)}var reddit_thing_info={fetch:[]};Thing.prototype={__init__:function(b,a){this._id=b;this._context=a;this.row=this.$("thingrow");if(this.row){if(!this.max_height()){this.set_height("fit")}}},_fade_and_hide:function(c){c=Math.max(Math.min(c,1),0);var b=Math.max(Math.min(2*c,1),0);var a=Math.max(Math.min(2*c-1,1),0);if(c==0){this.hide()}else{if(this.row.style.display=="none"){this.show()}}this.set_opacity(a);this.set_height((b==1)?"fit":(this.max_height()*b));this.row.cur_hide=c},set_opacity:function(b){this.row.style.opacity=b;var a="alpha(opacity="+parseInt(b*100)+")";this.row.style.filter=a;this.row.style.zoom=1},get:function(a){return this.$(a)},$:function(a,b){var c=a+"_"+this._id;if(!b){b=this._context}if(!b){return $(c)}if(b.id===c){return b}return jQuery(b).find("#"+c)[0]},_fade_step:function(a,c){if(c==this.row.fading){var b=Math.max(Math.min(a,1),0);this.set_opacity(b)}},fade:function(c,b){var a=this;this.row.fading=true;animate(function(d){a._fade_step(d,true)},0,c,b)},unfade:function(c,b){var a=this;this.row.fading=false;animate(function(d){a._fade_step(d,false)},1,c,b)},_hide_step:function(a){if(this.row.cur_hide==null){this.row.cur_hide=1}if(this.row.hiding&&a<this.row.cur_hide){this._fade_and_hide(a)}},_show_step:function(a){if(this.row.cur_hide==null){this.row.cur_hide=0}if(!this.row.hiding&&a>this.row.cur_hide){this._fade_and_hide(a)}},hide:function(b){this.row.hidden=true;if(b){var a=this;this.row.hiding=true;animate(function(c){a._hide_step(c)},0)}else{hide(this.row);if(this.__destroy&&this.row&&this.row.parentNode){this.row.parentNode.removeChild(this.row)}}},show:function(g){this.row.hidden=false;if(g){var d=this;this.row.hiding=false;animate(function(f){d._show_step(f)},1)}else{show(this.row)}if(reddit_thing_info.fetch&&reddit_thing_info.fetch.length!=0){var h=reddit_thing_info.fetch;for(var c=0;c<h.length;c++){if(h[c]==this._id){redditRequest("onload",{ids:h.join(",")},handleOnLoad,true);break}}}if(reddit_thing_info&&reddit_thing_info[this._id]){var a=this.$("promote_img");var b=unsafe(reddit_thing_info[this._id][0]);var e=unsafe(reddit_thing_info[this._id][1]);if(a&&a.src!=b){a.src=b;this.$("title").href=e;if(this.$("thumbnail")){this.$("thumbnail").href=e}}}},del:function(a){this.__destroy=true;this.hide(a)},child_listing:function(){var b=this.$("child");if(!Listing.exists(this._id,this._context)){var a=Listing.create(this._id,this._context);b.insertBefore(a.ajaxHook,b.firstChild);b.insertBefore(a.listing,b.firstChild)}return new Listing(this._id,this._context)},is_visible:function(){if(this.row){if(this.row.hidden==null){this.row.hidden=(this.row.style.display=="none")}return !this.row.hidden}return false},compute_height:function(){var b=this.$("arrows");var d=this.$("entry");var a=this.$("thumbnail");var c=this.$("num");return Math.max(b?b.offsetHeight:0,d?d.offsetHeight:0,a?a.offsetHeight:0,c?c.offsetHeight:0)},parent_listing:function(){return Listing.attach(this.row.parentNode)},max_height:function(){return this.row._height+this.row._top_pad+this.row._bot_pad},get_height:function(){return this.row.offsetHeight},set_height:function(e){var f=this.$("entry");var c=this.$("thumbnail");var b=this.$("arrows");var d=this.$("num");if(e=="fit"||(this.max_height()&&e>=this.max_height()*0.9)){this.row.style.paddingTop="";this.row.style.paddingBottom="";e=""}else{if(e<=0){this.row.style.paddingTop="0px";this.row.style.paddingBottom="0px";e="0px"}else{if(this.row._top_pad&&e<=this.row._top_pad){this.row.style.paddingTop=e+"px";this.row.style.paddingBottom="0px";e="0px"}else{var a;if(this.row.style.height){a=parseInt(this.row.style.height)}else{a=this.compute_height()}var g=this.row.offsetHeight-a;this.row.style.paddingTop="";if(e<g){this.row.style.paddingBottom=Math.max(e-this.row._top_pad,0)+"px";e=0}e+="px"}}}f.style.height=e;if(b){b.style.height=e}if(c){c.style.height=e}if(d){if(e){d.style.marginTop=0}else{d.style.marginTop=""}d.style.height=e}this.row.style.height=e;if(e==""&&this.is_visible()){a=this.compute_height();top_pad=f.offsetTop-this.row.offsetTop-1;bot_pad=this.row.offsetHeight-a-top_pad-1;this.row._height=a;this.row._top_pad=top_pad;this.row._bot_pad=bot_pad}return this.row.offsetHeight}};Thing.del=function(a){new Thing(a.id).del(true)};Thing.findAll=function(f){var b=jQuery(document.body).find("#thingrow_"+f);var d=[];for(var c=0,a=b.length;c<a;++c){d.push(new Thing(f,b[c]))}return d};Thing.getThingRow=function(a){do{if(/^thingrow_/.test(a.id)){return a}}while(a=a.parentNode)};function Listing(b,a){this.__init__(b,a)}Listing.prototype={__init__:function(b,a){this._id=b;this._context=a;this.listing=this.$("siteTable");this.ajax_hook=this.$("ajaxHook");if(this.listing){if(!this.listing.start_count){this.listing.start_count=this.visible_count()}}},$:function(a){var b=a+(this._id?"_"+this._id:"");if(!this._context){return $(b)}if(this._context.id===b){return this._context}return jQuery(this._context).find("#"+b)[0]},insert_node_before:function(c,a,b){a=a||this.listing.firstChild;if(!b&&a){this.listing.insertBefore(c,a)}else{this.listing.appendChild(c)}},insert:function(f,j,c){var h=this.ajax_hook;h.innerHTML=f;var g=h.childNodes;var d=[];for(var e=0;e<g.length;e++){var b=_id(g[e]);if(b){var k=new Thing(b,this._context);k.set_height("fit");k.hide();d.unshift(k)}this.insert_node_before(g[e],j,c)}return d},push:function(a){return this.insert(a,this.listing.firstChild)},append:function(a){return this.insert(a,null,true)},map:function(b){if(this.listing){var e=this.listing.childNodes;for(var a=0;a<e.length;a++){var d=_id(e[a]);if(d){b(new Thing(d))}}}},select:function(b){var a=[];this.map(function(c){if(b(c)){a.unshift(c)}});return a},visible_count:function(){return this.select(function(a){return a.is_visible()}).length},renumber:function(a){var b=a;this.map(function(d){var c=d.$("num");if(c.firstChild.innerHTML){c=c.firstChild}if(c){var e=parseInt(c.innerHTML);b=b||e;if(d.is_visible()){c.innerHTML=(b++)}}})},reset_visible_count:function(a){a=a||this.listing.start_count;this.map(function(b){if(b.is_visible()){if(--a<0){b.hide()}}});this.renumber()}};Listing.exists=function(b,a){return new Listing(b,a).$("siteTable")};Listing.attach=function(a){var c=/siteTable_?(.*)/.exec(a.id);if(c){var b=new Listing(c[1],a);if(b.listing){return b}}};Listing.create=function(c,b){var a=new Listing(c,b);if(!a.listing){a.listing=document.createElement("div");a.listing.id="siteTable_"+c;a.ajaxHook=document.createElement("div");a.ajaxHook.id="ajaxHook_"+c;a.ajaxHook.className="ajaxhook"}return a};function make_sr_list(c){var a=[];for(var b in c){if(!(b in Object.prototype)&&c[b]!=null){a.unshift(b+":"+(c[b]?1:0))}}return a.join(",")}Listing.fetch_more=function(c,d,a){var b=update_get_params({srs:make_sr_list(c)});new Ajax.Request(where.path+".json-html",{parameters:make_get_params(b),method:"get",onComplete:Listing_merge(d,a)})};function _fire_and_hide(a){return function(b){redditRequest(a,{id:b,uh:modhash});new Link(b).hide(true)}}Listing.unhide=_fire_and_hide("unhide");Listing.hide=_fire_and_hide("hide");Listing.report=_fire_and_hide("report");Listing.retract=function(a){redditRequest("retract",{id:a,uh:modhash},function(b){var c=parse_response(b);if(c.error){alert(c.error.message)}else{$("body_"+a).addClassName("retracted")}})};Listing.del=function(a){redditRequest("del",{id:a,uh:modhash},function(b){var c=parse_response(b);if(c.error){alert(c.error.message)}else{new Link(a).hide(true)}})};Listing.parse=function(d){var a=[];var e=parse_response(d);if(e&&e.response){var d=e.response.object;for(var c=0;c<d.length;c++){if(d[c].kind=="Listing"){for(var b=0;b<d[c].data.length;b++){a.push(d[c].data[b].data)}}}}return a};function Listing_merge(b,a){return function(j){var c=new Listing("");var e=Listing.parse(j);var m=[];var h=Math.max(c.listing.start_count,e.length);for(var g=0;g<e.length;g++){var k=e[g];var f=new Thing(k.id);if(f.row){if(!f.is_visible()){m.unshift(f)}}else{if(!a&&g<h){f=c.insert(unsafe(k.content),c.listing.childNodes[g+1])}else{f=c.append(unsafe(k.content))}if(k.sr==b||(a&&g>=h-a)){m=m.concat(f)}vl[k.id]=k.vl;sr[k.id]=k.sr}}for(var g=0;g<m.length;g++){m[g].show(true)}add_to_aniframes(function(){c.reset_visible_count(h)},1);return}}function Link(a){this.__init__(a)}Link.prototype=new Thing();Link.prototype.share=function(){var a=new ShareLink(this._id);a.attach(this.$("child"))};function linkstatus(a){var b=field(a.title);if(b){return _global_submitting_tag}return _global_fetching_tag}function setClick(b,c){c=c||"title";var d=_id(b);if(d){if(logged){b.className=c+" loggedin click"}else{b.className=c+" click"}setClickCookie(d)}return true}function setClickCookie(b){var a=readCookie("click")+b+":";createCookie("click",a)}function ThingForm(a){this.__init__(a)}ThingForm.prototype={__init__:function(b){this._id=b;this.form=$(this.__name__+"_"+b);if(!this.form){var a=this.__prototype__();if(a){this.form=re_id_node(a.cloneNode(true),b)}}else{show(this.form)}},__name__:"",__prototype__:function(){return $(this.__name__+"_")},$:function(a){return $(a+"_"+this._id)},cancel:function(){hide(this.form);return false},ok:function(){return true},attach:function(a){if(this.form.parentNode){if(this.form.parentNode!=a){this.form.parentNode.removeChild(this.form);a.insertBefore(this.form,a.firstChild)}}a.insertBefore(this.form,a.firstChild);show(this.form)}};function ShareLink(a){this.__init__(a)}ShareLink.prototype=new ThingForm();ShareLink.prototype.__name__="sharelink";ShareLink.prototype.ok=function(){var b=this.__prototype__();var a=this.$("share_to").value.replace(/[\s,;]+/g,"\r\n");b.firstChild.share_to.value=a;b.firstChild.share_to.innerHTML=a;return true};function share(a){if(logged){new Link(a).share()}else{showcover(true,"share_"+a)}};function fillInHelpDiv(b,a){b.innerHTML=a;b.select(".invalidate").first().observe("submit",function(c){c.stop();b.innerHTML="Loading...";new Ajax.Request(this.getAttribute("action"),{method:"post",parameters:{skiplayout:"on"},onSuccess:function(d){fillInHelpDiv(b,d.responseText)}})})}function getHelpContent(a){new Ajax.Request("/wiki/Commentmarkuphelp",{method:"get",parameters:{skiplayout:"on"},onSuccess:function(b){fillInHelpDiv(a,b.responseText)}})}function helpon(b,c,d){var e=_id(b);show(c+e);if(/\s*Loading/.match($(c+e).innerHTML)){getHelpContent($(c+e))}var a=b.innerHTML;if(d){b.innerHTML=d}b.onclick=function(){return helpoff(b,c,a)};b.blur();return false}function helpoff(b,c,d){var e=_id(b);hide(c+e);var a=b.innerHTML;if(d){b.innerHTML=d}b.onclick=function(){return helpon(b,c,a)};b.blur();return false}function Comment(c,a){this.__init__(c,a);var b=this.get("edit_body");if(b){this.text=decodeURIComponent(b.innerHTML.replace(/\+/g," "))}}Comment.prototype=new Thing();Comment.del=Thing.del;Comment.prototype.$parent=function(b,a){a=a||this._context;return this.$(b,a&&a.parentNode)};Comment.prototype.cloneAndReIDNodeOnce=function(c){var b=this.$parent(c);if(b){return b}var a=$(c)||$(c+"_");return re_id_node(a.cloneNode(true),this._id)};Comment.prototype.show_editor=function(f,a,e){var d=this.cloneAndReIDNodeOnce("samplecomment");if(d.parentNode!=f.listing){if(d.parentNode){d.parentNode.removeChild(d)}f.insert_node_before(d,a)}else{if(d.parentNode.firstChild!=d){var c=d.parentNode;c.removeChild(d);c.insertBefore(d,c.firstChild)}}var b=this.$parent("comment_reply");clearTitle(b);b.value=e;b.setAttribute("data-orig-value",e);show(d);BeforeUnload.bind(Comment.checkModified,this._id);return d};Comment.prototype.edit=function(){this.show_editor(this.parent_listing(),this.row,this.text);this.$parent("commentform").replace.value="yes";this.hide()};Comment.prototype.showFlamebaitOverlay=function(c){var e=this;var a=this.$("flamebaitcommentoverlay");if(a){return}a=this.cloneAndReIDNodeOnce("flamebaitcommentoverlay");jQuery(c).children().hide();c.appendChild(a);show(a);function d(){a.remove();jQuery(c).find("form").show()}function b(){e.cancel()}jQuery(a).find(".flamebaitcomment-yes").bind("click",d);jQuery(a).find(".flamebaitcomment-no").bind("click",b)};Comment.prototype.reply=function(a){var b=this.show_editor(this.child_listing(),null,"");this.$parent("commentform").replace.value="";if(a){this.showFlamebaitOverlay(b)}else{this.$parent("comment_reply").focus()}};Comment.prototype.cancel=function(){var a=this.cloneAndReIDNodeOnce("samplecomment");hide(a);BeforeUnload.unbind(Comment.checkModified,this._id);this.show()};Comment.comment=function(b,a){var d=b.id;var c=b.parent;new Comment(c,a).cancel();new Listing(c,a).push(unsafe(b.content));new Comment(b.id,a).show();vl[d]=b.vl};Comment.checkModified=function(b){var a=$("comment_reply_"+b);if(a.value!==a.getAttribute("data-orig-value")){return"You've started typing a comment but haven't submitted it."}};Link.comment=Comment.comment;Comment.morechildren=function(d,a){var e=new Thing(d.id,a);if(e.row){e.del()}var b=new Thing(d.parent,a).child_listing();b.append(unsafe(d.content));e=new Thing(d.id,a);e.show(true);vl[d.id]=d.vl;highlightNewComments()};Comment.editcomment=function(c,b){var a=new Comment(c.id,b);a.get("body").innerHTML=unsafe(c.contentHTML);a.get("edit_body").innerHTML=unsafe(c.contentTxt);a.cancel();a.show()};Comment.submitballot=function(b){var a=new Comment(b.id);a.get("body").innerHTML=unsafe(b.contentHTML);a.cancel();a.show()};Comment.prototype.collapse=function(){hide(this.get("child"));hide(this.get("display"));hide(this.get("arrows"));show(this.get("collapsed"))};Comment.prototype.uncollapse=function(){show(this.get("child"));show(this.get("display"));show(this.get("arrows"));hide(this.get("collapsed"))};function all_morechildren(a){$$(".morechildren a").each(function(b,c){b.simulate("click")});return false}function morechildren(d,e,c,f){var h=_id(d);d.innerHTML=_global_loading_tag;d.style.color="red";var a={link_id:e,children:c,depth:f,id:h};var b=jQuery(d).closest(".comment")[0];function g(l){var j=l.response&&l.response.object;if(j&&j.length){for(var k=0,i=j.length;k<i;++k){Comment.morechildren(j[k].data,b)}}}redditRequest("morechildren",a,null,false,{cleanup_func:g,handle_obj:false});return false}function getAttrTime(a){return parseInt(a.readAttribute("time"))}function highlightNewComments(){var b=$("lastViewed");if(!b){return}var a=getAttrTime(b);if(a<=0){return}$$("div.comment").each(function(e,d){var c=getAttrTime(e.select(".comment-date")[0]);if(a<c){e.addClassName("new-comment")}})}document.observe("dom:loaded",function(){if($$(".morechildren a").length>0){var a=$$("#loadAllComments").first();if(a){a.show()}}highlightNewComments()});function editcomment(b,a){new Comment(b,Thing.getThingRow(a)).edit()}function cancelReply(a){new Comment(_id(a),Thing.getThingRow(a)).cancel()}function reply(d,c,b){if(logged){var a=new Comment(d,Thing.getThingRow(c)).reply(b)}else{showcover(true,"reply_"+d)}}function chkcomment(c){if(checkInProgress(c)){var b=confirm("Request still in progress\n(click Cancel to attempt to stop the request)");if(b==false){tagInProgress(c,false)}return false}var d=c.replace.value?"editcomment":"comment";var a=Thing.getThingRow(c);tagInProgress(c,true);function e(i){tagInProgress(c,false);var g=i&&i.response&&i.response.object;if(g&&g.length){for(var h=0,f=g.length;h<f;++h){Comment[d](g[h].data,a)}}}return post_form(c,d,null,null,true,null,{handle_obj:false,cleanup_func:e})}function tagInProgress(b,a){if(a){b.addClassName("inprogress")}else{b.removeClassName("inprogress")}}function checkInProgress(a){return a.hasClassName("inprogress")}function clearTitle(a){if(a.rows&&a.rows<7||a.style.color=="gray"||a.style.color=="#808080"){a.value="";a.style.color="black";if(a.rows){a.rows=7}try{a.focus()}catch(b){}}}function hidecomment(c,b){var a=new Comment(c,Thing.getThingRow(b));a.collapse();return false}function showcomment(c,b){var a=new Comment(c,Thing.getThingRow(b));a.uncollapse();return false}Message=Comment;Message.message=Comment.comment;function subscribe(a,d){if(!logged){return showcover()}var c="sr-toggle-button add";var b="sr-toggle-button remove";if(a.className==c){action="sub";a.className=b;set_score(d,1)}else{action="unsub";a.className=c;set_score(d,0)}redditRequest_no_response("subscribe",{sr:d,action:action,uh:modhash})}function Subreddit(a){}Subreddit.prototype=new Thing();function map_links_by_sr(a,d){var e=$("sr_sel_chx_"+a);var c=0;if(e){e=e.checked}for(var b in sr){if(sr[b]==a){d(new Link(b),e);c+=1}}return c}var changed_srs={};function change_sr(b){var f=$("sr_sel_chx_"+b);var e=[];if(changed_srs[b]==null){changed_srs[b]=f.checked}else{changed_srs[b]=null}var d=false;for(var a in changed_srs){if(!(a in Object.prototype)&&changed_srs[a]!=null){d=true;break}}if(d){show("subscr_sub")}else{hide("subscr_sub")}if(f.checked){show_by_srid(b,changed_srs)}else{hide_by_srid(b,changed_srs)}var c=$("sr_sel_"+b);c.className=(f.checked&&"selected")||"";return true}function hide_by_srid(c,a){var b=new Listing("");var d=map_links_by_sr(c,function(f,e){if(f.row.parentNode==b.listing){f.hide(true)}})}function show_by_srid(c,a){var b=new Listing("");var d=map_links_by_sr(c,function(f,e){if(f.row.parentNode==b.listing){f.show(true)}});if(!d){Listing.fetch_more(a,c)}add_to_aniframes(function(){new Listing("").reset_visible_count()},1)};var upm="up mod";var upr="up";var downm="down mod";var downr="down";var upcls=[upr,upr,upm];var downcls=[downm,downr,downr];var scorecls=["votes dislikes","votes","votes likes"];function cookieName(a){return(logged||"")+"_"+a}function createLCookie(c,e,f){var d="; domain="+cur_domain;if(f){var b=new Date();b.setTime(b.getTime()+(f*24*60*60*1000));var a="; expires="+b.toGMTString()}else{a=""}document.cookie=c+"="+escape(e)+a+d+"; path=/"}function createCookie(a,b,c){return createLCookie(cookieName(a),b,c)}function readLCookie(d){d=d+"=";var a=document.cookie.split(";");for(var b=a.length-1;b>=0;b--){var e=a[b];while(e.charAt(0)==" "){e=e.substring(1,e.length)}if(e.indexOf(d)==0){return unescape(e.substring(d.length,e.length))}}return""}function readCookie(a){var b=cookieName(a);return readLCookie(b)}function set_score(e,b,c){var a=vl[e];var d=c?jQuery(c).find("#score_"+e)[0]:$("score_"+e);if(d){d.className=scorecls[b+1];d.textContent=a[b+1]["label"];jQuery(d).qtip("option","content.text",a[b+1]["hover"])}}function castVote(f,g){if(!logged){return}g=g||"";var a=_id(f);var k=new Thing(a,Thing.getThingRow(f));var e=k.$("up");var i=k.$("down");var c=k.$("status");var j=k.$("votespinner");var b=/\bmod\b/.test(f.className)?0:f===e?1:-1;if(c){hide(c)}function h(o){$(j.parentNode).removeClassName("inprogress");if(o.response&&o.response.update){return}var q=Thing.findAll(a);for(var n=0,m=q.length;n<m;++n){var l=q[n].$("up"),p=q[n].$("down");if(l&&p){q[n].$("up").className=upcls[b+1];q[n].$("down").className=downcls[b+1];set_score(a,b,q[n].row)}}}var d={id:a,uh:modhash,dir:b,vh:g};redditRequest("vote",d,null,false,{cleanup_func:h});$(j.parentNode).addClassName("inprogress")};var style="reddit";var cur_menu=null;var have_open=false;function open_menu(a){var b=a.nextSibling;if(b.className.indexOf("drop-choices")==-1){return}show(b);b.style.top=(a.offsetTop+a.offsetHeight)+"px";b.style.left=a.offsetLeft+"px";a.onclick=null;cur_menu=a;have_open=true}function close_menus(){uls=document.getElementsByTagName("DIV");for(var b=0;b<uls.length;b++){var a=uls[b];var c=a.previousSibling;if(c!=cur_menu&&a.className.indexOf("drop-choices")>-1){hide(a);c.onclick=function(){return open_menu(this)}}}if(!cur_menu){have_open=false}cur_menu=null}function hover_open_menu(a){if(have_open){open_menu(a);close_menus()}}function open_choice(b){var a=b.options[b.selectedIndex];if(window.location.toString()!=a.value){window.location=a.value}}var global_cookies_allowed=true;function init(d){var e=(ajax_domain||"").indexOf(":");var c=(e<0)?ajax_domain:ajax_domain.slice(0,e);e=(cur_domain||"").indexOf(":");cur_domain=(e<0)?cur_domain:cur_domain.slice(0,e);if(cur_domain!=c){global_cookies_allowed=false}else{if(cnameframe&&!logged){var b=Math.random()+"";createCookie("test",b);global_cookies_allowed=(readCookie("test")==b)}}if(global_cookies_allowed){updateClicks()}stc=$("siteTable_comments");if(reddit_thing_info.fetch&&reddit_thing_info.fetch.length!=0){updateLinks(reddit_thing_info.fetch)}update_reddit_count();populate_side_bar("side-meetups",d);populate_side_bar("side-comments",d);populate_side_bar("side-posts",d);populate_side_bar("side-open",d);populate_side_bar("side-quote",d);populate_side_bar("side-diary",d);populate_side_bar("side-tags",d);populate_side_bar("side-monthly-contributors",d);populate_side_bar("side-contributors",d);populate_side_bar("front-recent-posts",d);populate_side_bar("front-meetups-map",d,function(a){$("front-meetups-map").innerHTML=a.responseText;createMap($("front-map"))})}function populate_side_bar(g,b,f){var d=$(g);var c=b.r;var a="";if(c&&c.length>0){a="/r/"+c}if(!f){f=function(h){d.innerHTML=h.responseText}}if(d){var e=a+"/api/"+g.replace("-","_");new Ajax.Request(e,{method:"get",parameters:b,onSuccess:f})}}function toggle_article_navigation(a){var b=$("article_nav_controls");var c=$("articlenavstate");if(!(b&&a&&c)){return}if(!b.style.display){hide(b);c.className="dsphead"}else{if(b.children.length&&b.children[0].className=="loading"){new Ajax.Request("/api/article_navigation",{method:"get",parameters:"article_id="+escape(a),onSuccess:function(d){b.innerHTML=d.responseText}})}show(b);c.className="dsphead open"}}function updateLinks(c){for(var b=0;b<c.length;b++){var a=new Link(c[b]);if(a.row&&a.row.style.display!="none"){a.show()}}}function handleOnLoad(a){a=parse_response(a);var b=reddit_thing_info.fetch;reddit_thing_info.fetch=[];reddit_thing_info=(a&&a.response)?a.response.object:{};updateLinks(b)}function deletetoggle(g,f){var h=g.parentNode;var b=h.parentNode;g.blur();var a=document.createElement("span");a.className="question";a.innerHTML=b.question.value;var c=document.createElement("a");c.className="yes";c.innerHTML=b.yes.value;c.href="javascript:void(0)";var d=document.createTextNode("/");var i=document.createElement("a");i.className="no";i.innerHTML=b.no.value;i.href="javascript:void(0)";var e=h.innerHTML;i.onclick=function(){return untoggle(false,h,e,f)};c.onclick=function(){return untoggle(true,h,e,f)};a.appendChild(c);a.appendChild(d);a.appendChild(i);h.innerHTML="";h.appendChild(a);return false}function untoggle(e,c,a,b){if(e){var d=c.parentNode;var f=modhash;c.innerHTML=d.executed.value||a;if(b=="del"||b=="retract"){post_form(d,b,function(){return""})}else{if(typeof(b)=="string"){post_form(d,b,function(){return""})}else{if(typeof(b)=="function"){b(d.id.value,f)}}}}else{c.innerHTML=a}return false}function chklogin(b){if(global_cookies_allowed){var c=field(b.op);var a=$("status_"+c);if(a){a.innerHTML=_global_submitting_tag}if(c=="login"||c=="login-main"){post_form(b,"login")}else{post_form(b,"register");if(window.pageTracker){window.pageTracker._trackPageview("/NewSignup")}}return false}return true}function toggle_setting(b,f){var c=b.parentNode;post_form(c,f,function(){return""});var d=c.action.value;var e=c.toggled_label.value;c.toggled_label.value=b.innerHTML;b.innerHTML=e;var a=c.toggled_action.value;c.toggled_action.value=c.action.value;c.action.value=a;return false}function resizeCookie(a,d){var e=readCookie(a);if(e.length>d){var b=d;while(b>=0&&e[b--]!=";"){}createCookie(a,(b&&e.slice(0,b+1))||"")}}function updateClicks(){var b=readCookie("click");if(b){b=b.split(":");for(var a=0;a<b.length;a++){setClick(b[a])}}}function showlang(){offset=window.pageYOffset||document.body.scrollTop||document.documentElement.scrollTop;$("langcover").style.top=offset+"px";$("langpopup").style.top=40+offset+"px";show("langcover","langpopup");return false}function showcover(a,b){offset=window.pageYOffset||document.body.scrollTop||document.documentElement.scrollTop;if(a){show("cover_msg","cover_disclaim")}else{hide("cover_msg","cover_disclaim")}$("loginpopup").style.top=40+offset+"px";if(b=="sr_change_"){b+=make_sr_list(changed_srs)}if(b){$("login_login").elements.reason.value=b;$("login_reg").elements.reason.value=b}new_captcha();show("cover","loginpopup");return false}function hidecover(a,b){hide(a,b)}function check_some(){var a=false;var c=$("all-langs").form.elements;for(var b=0;b<c.length;b++){el=c[b];if(el.name.indexOf("lang-")!=-1&&el.checked){a=true;break}}if(a){var d=$("some-langs");d.checked="checked"}}function clear_all(){var b=$("all-langs");if(!b.checked){return}var c=b.form.elements;for(var a=0;a<c.length;a++){el=c[a];if(el.name.indexOf("lang-")!=-1){el.checked=false}}}function click(a){setClick(a);setClickCookie(a);return true}function frame(a,b){click(b);a.href="/goto?id="+b;return true}function set_sort(a,b){redditRequest("sort",{sort:b,where:a});return true}function disable_ui(c){var b=$(c+"-help");var a=$(c+"-gone");b.parentNode.innerHTML=a.innerHTML;redditRequest("disable_ui",{id:c})}function update_reddit_count(){if(!cur_site||!logged){return}var b=0.9;var c=86400;var n=10;var f=100;var k="_date";var m=new Date();var a="reddit_counts";var p="recent_reddits";var o=readCookie(a);if(o){o=o.evalJSON()}else{o={};o[k]=m.toString()}var h=new Date(o[k]);var j=m-h>c*1000;var l=[];o[cur_site]=(o[cur_site]||0)+1;for(var e in o){if(e==k||Object.prototype[e]){continue}if(j&&e!=cur_site){var d=Math.floor(b*o[e]);if(d>0){o[e]=d}else{delete o[e]}}if(o[e]){l.push(e)}}l.sort(function(r,i){return o[i]-o[r]});if(j){o[k]=m.toString()}var q="";for(var g=0;g<l.length;g++){var e=l[g];if(g<n){q+=l[g]+","}else{if(g>=f&&e!=cur_site){delete o[e]}}}createCookie(a,Object.toJSON(o));if(q){createCookie(p,q)}};function OrganicListing(){this.__init__("Organic");this._links=organic_links;if(!this.listing._loaded){this.listing._loaded={};var a=this;this.map(function(c){a.listing._loaded[c._id]=c;if(c.is_visible()){for(var b=0;b<a._links.length;b++){if(c._id==a._links[b]){a.listing.pos=b;break}}}a.listing.max_pos=a.listing.pos;a.listing.update_pos=true})}}OrganicListing.prototype=new Listing();OrganicListing.prototype.current=function(){return this.listing._loaded[this._links[this.listing.pos]]};OrganicListing.prototype.check_ahead=function(a,e){e=e||10;a=(a>0)?1:-1;var h=this.listing.pos;var f=this._links.length;var g=[];var l=null;for(var c=0;c<e;c++){var b=((c+1)*a+h+f)%f;if(!this.listing._loaded[this._links[b]]){g.unshift(this._links[b]);if(l==null){l=true}}else{if(l){l=false}}}if((l&&g.length>e/2)||(!l&&g.length>0)){g=g.join(",");var k=this.current();redditRequest("fetch_links",{num_margin:k.$("num").style.width,mid_margin:k.$("arrows").style.width,links:g},null,true)}};function _fire_and_shift(a){return function(b){redditRequest(a,{id:b,uh:modhash});get_organic(true)}}function update_organic_pos(a){var f=readLCookie("reddit_first");if(f!=""){try{f=f.evalJSON()}catch(b){f=""}}if(f==""){f={}}if(f.organic_pos&&f.organic_pos.length>=2){f.organic_pos[1]=a}else{f.organic_pos=["none",a]}createLCookie("reddit_first",Object.toJSON(f))}OrganicListing.unhide=_fire_and_shift("unhide");OrganicListing.hide=_fire_and_shift("hide");OrganicListing.report=_fire_and_shift("report");OrganicListing.del=_fire_and_shift("del");OrganicListing.populate=function(a){var e=new OrganicListing();for(var c=0;c<a.length;c++){d=a[c].data;var b=e.insert(unsafe(d.content),e.listing.firstChild);if(b&&b[0]){vl[d.id]=d.vl;e.listing._loaded[d.id]=b[0]}}};OrganicListing.prototype.change=function(b){b=(b>0)?1:-1;this.check_ahead(b);var h=this.listing.pos;var a=this._links.length;h=(h+b+a)%a;var g=this.listing._loaded[this._links[h]];var f=this.current();if(g&&f){if(b>0){if(this.listing.max_pos==h){this.listing.update_pos=true}else{if(this.listing.update_pos){update_organic_pos((h+1)%a);this.listing.max_pos=h}}}else{this.listing.update_pos=false}var e=this.listing;e.changing=true;e.pos=h;f.fade("veryfast");add_to_aniframes(function(){f.hide();g.show();g.set_opacity(0)},1);g.unfade("veryfast",2);add_to_aniframes(function(){e.changing=false},3)}};function get_organic(b){var a=new OrganicListing();if(a.listing.changing){return false}else{if(b){a.change(1)}else{a.change(-1)}}return false};(function(a){a(document).ready(function(){dropdownSel="ul#nav li img.dropdown";a(dropdownSel).click(function(f){var d=a(this).next("ul");var c=a(d).is(":visible");a(dropdownSel).next("ul").hide();if(!c){d.show()}a(document).one("click",function(){a(d).hide()});return false});a("#post-filter div.filter-active").click(function(){a(this).toggleClass("open");a(this).next("div.filter-options").toggle();return false});a("#comment-controls div.filter-active").click(function(){a(this).toggleClass("open");a(this).next("div.filter-options").toggle();return false});function b(){return((navigator.platform.indexOf("iPhone")!=-1)||(navigator.platform.indexOf("iPod")!=-1)||(navigator.platform.indexOf("iPad")!=-1))}if(!b()){a("div.tools div.vote a, div.tools div.boxright a.edit, div.tools div.boxright a,        div.comment-links ul li a,        .userinfo .score, .userinfo .monthly-score, .votes").qtip({position:{my:"bottom center",at:"top center"},style:{classes:"ui-tooltip-lesswrong",tip:{border:0,corner:"bottom center",height:7,width:10}}})}})})(jQuery);(function(a){window.createMap=function(b){if(!b){return}loadMaps(function(){var g=a(".marker",b);var c={zoom:12,mapTypeId:google.maps.MapTypeId.ROADMAP};var d=new google.maps.Map(b,c);var f;var e=new google.maps.LatLngBounds();g.each(function(n,h){var o=a(h).attr("data-latitude");var l=a(h).attr("data-longitude");var p=new google.maps.LatLng(o,l);e.extend(p);if(!f){f=p}var j=new google.maps.Marker({map:d,draggable:false,animation:google.maps.Animation.DROP,position:p,title:a(h).attr("data-title")});var k=a(h).attr("data-url");if(k){google.maps.event.addListener(j,"click",function(){window.location.href=k})}});if(e.getNorthEast().lat()!==e.getSouthWest().lat()||e.getNorthEast().lng()!==e.getSouthWest().lng()){d.fitBounds(e)}if(f){d.setCenter(f)}})};window.makeGeocodedInputWidget=function(k){var c=k.prompt||"";var j=k.input;var g=a('<img class="field-status-icon" src="about:blank" alt="" style="display:none">')[0];var f=a('<div class="form-info-line" />').text(c)[0];a(j).after(f).after(g);var h=false;var e=null;var b={none:{show:false,blank:true,src:"about:blank"},spinner:{show:true,blank:true,src:"/static/spinner.gif"},ok:{show:true,blank:false,src:"/static/accept.png"},error:{show:true,blank:true,src:"/static/exclamation.png"}};function d(l,n){var m=b[l];a(g).attr({src:m.src}).css({display:m.show?"":"none"});if(m.blank){a([k.latitude,k.longitude]).val("")}if(n!==void 0){a(f).text(n)}}function i(){var n=this.value;if(!n){d("none",c);return}d("spinner");var m=new google.maps.Geocoder();var l={address:n};h=true;m.geocode(l,function(r,q){if(q===google.maps.GeocoderStatus.OK){var o=r.first();var p=o.geometry.location;d("ok",o.formatted_address);a(k.latitude).val(p.lat());a(k.longitude).val(p.lng())}else{d("error",c)}h=false;if(e){e()}})}loadMaps(function(){a(j).bind("change",i).trigger("change");var l=a(j).closest("form");l.bind("submit",function(m){j.blur();if(h){m.preventDefault();e=function(){l.submit()}}})})}})(jQuery);window.Poll={};Poll.submitBallot=function(d){var h=Thing.getThingRow(d);var g=_id(h);var c=jQuery(d).find(".poll-voting-area");if(!logged){showcover(true,"vote_"+g);return}var f={uh:modhash,owner_thing:g};for(var b=0;b<d.elements.length;b++){var e=field(d.elements[b]);if(e){f[d.elements[b].name]=e}}function a(){c.removeClass("inprogress")}c.addClass("inprogress");result=redditRequest("submitballot",f,null,true,{cleanup_func:a})};